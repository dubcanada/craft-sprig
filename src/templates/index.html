{% extends '_layouts/cp' %}

{% set title = 'Sprig Playground'|t('sprig') %}

{% do view.registerAssetBundle('putyourlightson\\sprig\\assets\\PlaygroundAsset') %}


{% block actionButton %}

    <a href="https://putyourlightson.com/plugins/sprig" class="btn" target="_blank">{{ 'Docs'|t('sprig') }}</a>
    <a href="https://putyourlightson.com/sprig-cookbook" class="btn" target="_blank">{{ 'Cookbook'|t('sprig') }}</a>
    <a href="https://github.com/putyourlightson/craft-sprig/issues" class="btn" target="_blank">{{ 'Issues'|t('sprig') }}</a>

{% endblock %}


{% block main %}

    <div class="playground">
        <div>
            <div class="content-pane">
                <p class="light code">{{ 'Component'|t('sprig') }}</p>
                <div id="editor" style="height: 100%"></div>
                <textarea id="input" class="hidden">
                    {%- verbatim -%}
<h1>
    Hello {{ currentUser.firstName }}!
</h1>

<button sprig s-vars="count:{{ count + 1 }}" class="btn submit">
    Re-render
</button>

<p>
    <em>Component re-rendered {{ count }} times</em>
</p>
                    {%- endverbatim -%}
                </textarea>
                <button id="create" type="submit" class="btn submit topright">{{ 'Create'|t('sprig') }}</button>
            </div>
            <div class="variables content-pane">
                <p class="light code">{{ 'Component Variables'|t('sprig') }}</p>
                <input id="input-variables" class="input code fullwidth field" value="count=0" placeholder="x=1,y=2,z=3">
            </div>
        </div>

        <div>
            <div class="output content-pane">
                <p class="light code">
                    {{ 'Output'|t('sprig') }}
                    <span id="spinner" class="spinner" style="display: none;"></span>
                </p>
                <a href="#" id="output-toggle" class="btn topright">&lt; &gt;</a>
                {{ sprig('SprigPlayground', {}, {id: 'playground'}) }}
                <textarea id="sourcecode" class="code fullwidth field" style="display: none;" disabled></textarea>
            </div>
            <div class="variables content-pane">
                <p class="light code">{{ 'Output Variables'|t('sprig') }}</p>
                <input id="output-variables" class="input code fullwidth field" value="" disabled>
            </div>
        </div>
    </div>

    {{ sprig.script }}
    {{ sprig.hyperscript }}

    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

    {% js %}
        let suggestions = [
            {% for attribute in sprig.getHtmxAttributes() %}
                {
                    label: 's-{{ attribute }}',
                    insertText: 's-{{ attribute }}=""',
                    kind: 1,
                },
            {% endfor %}
        ];
    {% endjs %}

{% endblock %}
